<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion √âtats des Lieux</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Section Authentification -->
    <div id="auth-section" class="section">
        <div class="container-auth">
            <h1>Gestion d'√âtats des Lieux</h1>

            <div class="auth-forms">
                <div class="form-container">
                    <h2>Connexion</h2>
                    <form id="login-form">
                        <input type="email" id="login-email" placeholder="Email" required>
                        <input type="password" id="login-password" placeholder="Mot de passe" required>
                        <button type="submit">Se connecter</button>
                    </form>
                </div>

                <div class="form-container">
                    <h2>Inscription</h2>
                    <form id="register-form">
                        <input type="text" id="register-nom" placeholder="Nom" required>
                        <input type="email" id="register-email" placeholder="Email" required>
                        <input type="password" id="register-password" placeholder="Mot de passe" required>
                        <button type="submit">S'inscrire</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Section Liste des Biens -->
    <div id="biens-section" class="section hidden">
        <nav class="navbar">
            <h1>Mes Biens Immobiliers</h1>
            <div>
                <span id="user-name"></span>
                <button id="logout-btn" class="btn-secondary">D√©connexion</button>
            </div>
        </nav>

        <div class="container">
            <div class="section-header">
                <h2>Mes Biens</h2>
                <button id="add-bien-btn" class="btn-primary">+ Ajouter un bien</button>
            </div>

            <div id="biens-list" class="items-grid"></div>
        </div>

        <!-- Modal pour ajouter un bien -->
        <div id="bien-modal" class="modal hidden">
            <div class="modal-content">
                <h3>Nouveau Bien Immobilier</h3>
                <input type="text" id="bien-nom" placeholder="Nom du bien (ex: Appartement Paris 15)">
                <input type="text" id="bien-adresse" placeholder="Adresse compl√®te">
                <div class="modal-actions">
                    <button id="save-bien-btn" class="btn-primary">Cr√©er</button>
                    <button class="close-modal btn-secondary">Annuler</button>
                </div>
            </div>
        </div>

        <!-- Modal pour modifier un bien -->
        <div id="edit-bien-modal" class="modal hidden">
            <div class="modal-content">
                <h3>Modifier le Bien</h3>
                <input type="text" id="edit-bien-nom" placeholder="Nom du bien">
                <input type="text" id="edit-bien-adresse" placeholder="Adresse compl√®te">
                <div class="modal-actions">
                    <button id="update-bien-btn" class="btn-primary">Enregistrer</button>
                    <button class="close-modal btn-secondary">Annuler</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section D√©tails du Bien -->
    <div id="bien-detail-section" class="section hidden">
        <nav class="navbar">
            <button id="back-btn" class="btn-secondary">‚Üê Retour</button>
            <h1 id="bien-name"></h1>
            <div>
                <button id="demarrer-etat-btn" class="btn-success">üöÄ D√©marrer un √©tat des lieux</button>
                <button id="generate-pdf-btn" class="btn-secondary">üìÑ PDF du template</button>
            </div>
        </nav>

        <div class="container">
            <div class="bien-info">
                <p><strong>Adresse:</strong> <span id="bien-adresse-display"></span></p>
            </div>

            <!-- Section Contrat en cours -->
            <div class="contrat-actif-section">
                <div class="section-header-with-action">
                    <h3>üìã Contrat en cours</h3>
                    <button id="create-contrat-btn" class="btn-success">+ Cr√©er un contrat</button>
                </div>
                <div id="contrat-actif-container"></div>
            </div>

            <!-- Section Photos -->
            <div class="photos-section">
                <div class="section-header-with-action">
                    <h3>üì∏ Photos du bien</h3>
                    <button id="add-photo-btn" class="btn-primary">+ Ajouter une photo</button>
                </div>
                <div id="photos-container" class="photos-grid"></div>
            </div>

            <!-- Section Archive Documents -->
            <div class="documents-archive-section">
                <h3>üìÅ Archive des documents</h3>
                <div class="documents-explorer">
                    <div class="explorer-toolbar">
                        <div class="breadcrumb">
                            <i class="fas fa-folder-open"></i>
                            <span>Documents</span>
                        </div>
                        <div class="view-options">
                            <button class="view-btn active" data-view="grid" title="Affichage grille">
                                <i class="fas fa-th"></i>
                            </button>
                            <button class="view-btn" data-view="list" title="Affichage liste">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                    <div id="documents-container" class="documents-grid view-grid"></div>
                </div>
            </div>

            <!-- Tableau de l'√©tat des lieux (Template) -->
            <div class="etat-lieux-section">
                <h3>Template de l'√©tat des lieux</h3>

                <!-- Ajout d'objets et sections -->
                <div class="add-objet-inline">
                    <div class="add-buttons">
                        <button id="add-section-btn" class="btn-secondary">+ Ajouter une section</button>
                        <button id="add-objet-btn" class="btn-primary">+ Ajouter un √©l√©ment</button>
                    </div>
                </div>

                <div id="etat-container">
                    <p id="empty-message" class="empty-state hidden">Aucun √©l√©ment. Ajoutez des sections et des √©l√©ments pour cr√©er l'√©tat des lieux.</p>
                </div>
            </div>

            <!-- Modal pour ajouter une section -->
            <div id="section-modal" class="modal hidden">
                <div class="modal-content">
                    <h3>Nouvelle Section</h3>
                    <input type="text" id="section-nom" placeholder="Nom de la section (ex: Salle de bain, Salon...)">
                    <div class="modal-actions">
                        <button id="save-section-btn" class="btn-primary">Cr√©er</button>
                        <button class="close-modal btn-secondary">Annuler</button>
                    </div>
                </div>
            </div>

            <!-- Modal pour ajouter un objet -->
            <div id="objet-modal" class="modal hidden">
                <div class="modal-content">
                    <h3>Nouvel √âl√©ment</h3>
                    <input type="text" id="objet-nom" placeholder="Nom de l'√©l√©ment">
                    <input type="text" id="objet-description" placeholder="Description (optionnel)">
                    <select id="objet-section">
                        <option value="">Sans section</option>
                    </select>
                    <div class="modal-actions">
                        <button id="save-objet-btn" class="btn-primary">Cr√©er</button>
                        <button class="close-modal btn-secondary">Annuler</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section Liste des √âtats des Lieux -->
    <div id="etats-list-section" class="section hidden">
        <nav class="navbar">
            <button id="back-from-etats-btn" class="btn-secondary">‚Üê Retour au bien</button>
            <h1>√âtats des Lieux R√©alis√©s</h1>
            <button id="demarrer-etat-from-list-btn" class="btn-success">üöÄ D√©marrer un √©tat des lieux</button>
        </nav>

        <div class="container">
            <div id="etats-list" class="items-grid"></div>
        </div>
    </div>

    <!-- Section Consultation/Modification d'un √âtat des Lieux -->
    <div id="etat-detail-section" class="section hidden">
        <nav class="navbar">
            <button id="back-from-etat-btn" class="btn-secondary">‚Üê Retour</button>
            <h1 id="etat-title"></h1>
            <div>
                <button id="creer-etat-sortie-btn" class="btn-success hidden">üö™ Cr√©er l'√©tat de sortie</button>
                <button id="generate-etat-pdf-btn" class="btn-success">üìÑ G√©n√©rer PDF</button>
                <button id="terminer-etat-btn" class="btn-primary">‚úì Terminer</button>
            </div>
        </nav>

        <div class="container">
            <div class="etat-info">
                <p><strong>Type:</strong> <span id="etat-type-display"></span></p>
                <p><strong>Locataire:</strong> <span id="etat-locataire-display"></span></p>
                <p><strong>Date:</strong> <span id="etat-date-display"></span></p>
            </div>

            <!-- Tableau de l'√©tat des lieux -->
            <div class="etat-lieux-section">
                <h3>√âtat des Lieux</h3>
                <div id="etat-detail-container">
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour d√©marrer un √©tat des lieux -->
    <div id="demarrer-etat-modal" class="modal hidden">
        <div class="modal-content">
            <h3>D√©marrer un nouvel √©tat des lieux</h3>
            <label>
                Type d'√©tat des lieux:
                <select id="etat-type">
                    <option value="entree">√âtat d'entr√©e (vierge)</option>
                    <option value="sortie">√âtat de sortie</option>
                </select>
            </label>
            <div id="etat-entree-selector" class="hidden">
                <label>
                    S√©lectionner l'√©tat d'entr√©e:
                    <select id="etat-entree-id"></select>
                </label>
            </div>
            <label>
                Nom du locataire (optionnel):
                <input type="text" id="etat-locataire" placeholder="Nom du locataire">
            </label>
            <div class="modal-actions">
                <button id="start-etat-btn" class="btn-primary">D√©marrer</button>
                <button class="close-modal btn-secondary">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour ajouter une photo -->
    <div id="photo-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Ajouter une photo</h3>

            <div class="photo-upload-zone" id="photo-drop-zone">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Glissez une photo ici ou cliquez pour choisir</p>
                <input type="file" id="photo-file-input" accept="image/*" hidden>
            </div>

            <button id="photo-camera-btn" class="btn-secondary">
                <i class="fas fa-camera"></i> Prendre une photo
            </button>

            <input type="text" id="photo-legende" placeholder="L√©gende (optionnel)">

            <div id="photo-preview"></div>

            <div class="modal-actions">
                <button id="upload-photo-btn" class="btn-primary" disabled>Uploader</button>
                <button class="close-modal btn-secondary">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour cr√©er un contrat -->
    <div id="contrat-modal" class="modal hidden">
        <div class="modal-content modal-large">
            <h3>Cr√©er un contrat de bail</h3>

            <div class="form-grid">
                <div class="form-group">
                    <label>Nom du locataire *</label>
                    <input type="text" id="contrat-nom" required>
                </div>

                <div class="form-group">
                    <label>Pr√©nom du locataire *</label>
                    <input type="text" id="contrat-prenom" required>
                </div>

                <div class="form-group full-width">
                    <label>Adresse du locataire</label>
                    <input type="text" id="contrat-adresse-locataire">
                </div>

                <div class="form-group">
                    <label>Date de d√©but</label>
                    <input type="date" id="contrat-date-debut">
                </div>

                <div class="form-group">
                    <label>Date de fin</label>
                    <input type="date" id="contrat-date-fin">
                </div>

                <div class="form-group">
                    <label>Loyer mensuel (‚Ç¨)</label>
                    <input type="number" id="contrat-loyer" step="0.01">
                </div>

                <div class="form-group">
                    <label>Charges (‚Ç¨)</label>
                    <input type="number" id="contrat-charges" step="0.01">
                </div>

                <div class="form-group">
                    <label>D√©p√¥t de garantie (‚Ç¨)</label>
                    <input type="number" id="contrat-depot" step="0.01">
                </div>
            </div>

            <div class="modal-actions">
                <button id="save-contrat-btn" class="btn-primary">Cr√©er le contrat</button>
                <button class="close-modal btn-secondary">Annuler</button>
            </div>
        </div>
    </div>

    <div id="message" class="message hidden"></div>
    <div id="loading" class="loading hidden">Chargement...</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
